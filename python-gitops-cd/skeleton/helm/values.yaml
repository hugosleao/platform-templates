# Ambiente: {{ .Values.environment }}
# Account ID: {{ .Values.accountId }}
# Region: {{ .Values.region }}
# Platform: ${{ values.platform }}

app:
  name: ${{ values.sigla | lower }}-gitops-${{ values.platform }}
  version: {{ .Values.version | default "0.1.0" }}
  platform: ${{ values.platform }}
  
image:
  repository: ghcr.io/${{ values.destination.owner }}/{{ .Values.appImage | default "app-name" }}
  tag: {{ .Values.imageTag | default "latest" }}
  pullPolicy: IfNotPresent

{%- if values.platform == 'lbd' %}
# Lambda Configuration (via Crossplane)
lambda:
  memory: {{ .Values.lambda.memory | default 512 }}
  timeout: {{ .Values.lambda.timeout | default 30 }}
  runtime: python3.12
{%- else %}
# Kubernetes Configuration
replicas: {{ .Values.replicas | default 2 }}

resources:
  limits:
    cpu: {{ .Values.resources.limits.cpu | default "500m" }}
    memory: {{ .Values.resources.limits.memory | default "512Mi" }}
  requests:
    cpu: {{ .Values.resources.requests.cpu | default "250m" }}
    memory: {{ .Values.resources.requests.memory | default "256Mi" }}

service:
  type: ClusterIP
  port: 8000

ingress:
  enabled: {{ .Values.ingress.enabled | default false }}
  host: {{ .Values.ingress.host | default "" }}
{%- endif %}

env:
  - name: ENVIRONMENT
    value: {{ .Values.environment }}
  - name: AWS_REGION
    value: {{ .Values.region }}
  - name: PLATFORM
    value: ${{ values.platform }}
